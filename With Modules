This is the same code but uses modules
